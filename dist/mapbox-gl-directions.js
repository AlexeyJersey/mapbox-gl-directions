!function t(e,n,r){function i(s,a){if(!n[s]){if(!e[s]){var c="function"==typeof require&&require;if(!a&&c)return c(s,!0);if(o)return o(s,!0);var u=new Error("Cannot find module '"+s+"'");throw u.code="MODULE_NOT_FOUND",u}var l=n[s]={exports:{}};e[s][0].call(l.exports,function(t){var n=e[s][1][t];return i(n?n:t)},l,l.exports,t,e,n,r)}return n[s].exports}for(var o="function"==typeof require&&require,s=0;s<r.length;s++)i(r[s]);return i}({1:[function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{"default":t}}var i=t("./src/directions"),o=r(i);window.mapboxgl?mapboxgl.Directions=o["default"]:"undefined"!=typeof e&&(e.exports=o["default"])},{"./src/directions":42}],2:[function(t,e,n){function r(){this._events=this._events||{},this._maxListeners=this._maxListeners||void 0}function i(t){return"function"==typeof t}function o(t){return"number"==typeof t}function s(t){return"object"==typeof t&&null!==t}function a(t){return void 0===t}e.exports=r,r.EventEmitter=r,r.prototype._events=void 0,r.prototype._maxListeners=void 0,r.defaultMaxListeners=10,r.prototype.setMaxListeners=function(t){if(!o(t)||t<0||isNaN(t))throw TypeError("n must be a positive number");return this._maxListeners=t,this},r.prototype.emit=function(t){var e,n,r,o,c,u;if(this._events||(this._events={}),"error"===t&&(!this._events.error||s(this._events.error)&&!this._events.error.length)){if(e=arguments[1],e instanceof Error)throw e;var l=new Error('Uncaught, unspecified "error" event. ('+e+")");throw l.context=e,l}if(n=this._events[t],a(n))return!1;if(i(n))switch(arguments.length){case 1:n.call(this);break;case 2:n.call(this,arguments[1]);break;case 3:n.call(this,arguments[1],arguments[2]);break;default:o=Array.prototype.slice.call(arguments,1),n.apply(this,o)}else if(s(n))for(o=Array.prototype.slice.call(arguments,1),u=n.slice(),r=u.length,c=0;c<r;c++)u[c].apply(this,o);return!0},r.prototype.addListener=function(t,e){var n;if(!i(e))throw TypeError("listener must be a function");return this._events||(this._events={}),this._events.newListener&&this.emit("newListener",t,i(e.listener)?e.listener:e),this._events[t]?s(this._events[t])?this._events[t].push(e):this._events[t]=[this._events[t],e]:this._events[t]=e,s(this._events[t])&&!this._events[t].warned&&(n=a(this._maxListeners)?r.defaultMaxListeners:this._maxListeners,n&&n>0&&this._events[t].length>n&&(this._events[t].warned=!0,console.error("(node) warning: possible EventEmitter memory leak detected. %d listeners added. Use emitter.setMaxListeners() to increase limit.",this._events[t].length),"function"==typeof console.trace&&console.trace())),this},r.prototype.on=r.prototype.addListener,r.prototype.once=function(t,e){function n(){this.removeListener(t,n),r||(r=!0,e.apply(this,arguments))}if(!i(e))throw TypeError("listener must be a function");var r=!1;return n.listener=e,this.on(t,n),this},r.prototype.removeListener=function(t,e){var n,r,o,a;if(!i(e))throw TypeError("listener must be a function");if(!this._events||!this._events[t])return this;if(n=this._events[t],o=n.length,r=-1,n===e||i(n.listener)&&n.listener===e)delete this._events[t],this._events.removeListener&&this.emit("removeListener",t,e);else if(s(n)){for(a=o;a-- >0;)if(n[a]===e||n[a].listener&&n[a].listener===e){r=a;break}if(r<0)return this;1===n.length?(n.length=0,delete this._events[t]):n.splice(r,1),this._events.removeListener&&this.emit("removeListener",t,e)}return this},r.prototype.removeAllListeners=function(t){var e,n;if(!this._events)return this;if(!this._events.removeListener)return 0===arguments.length?this._events={}:this._events[t]&&delete this._events[t],this;if(0===arguments.length){for(e in this._events)"removeListener"!==e&&this.removeAllListeners(e);return this.removeAllListeners("removeListener"),this._events={},this}if(n=this._events[t],i(n))this.removeListener(t,n);else if(n)for(;n.length;)this.removeListener(t,n[n.length-1]);return delete this._events[t],this},r.prototype.listeners=function(t){var e;return e=this._events&&this._events[t]?i(this._events[t])?[this._events[t]]:this._events[t].slice():[]},r.prototype.listenerCount=function(t){if(this._events){var e=this._events[t];if(i(e))return 1;if(e)return e.length}return 0},r.listenerCount=function(t,e){return t.listenerCount(e)}},{}],3:[function(t,e,n){!function(){var t=this,r={};"undefined"!=typeof n?e.exports=r:t.fuzzy=r,r.simpleFilter=function(t,e){return e.filter(function(e){return r.test(t,e)})},r.test=function(t,e){return null!==r.match(t,e)},r.match=function(t,e,n){n=n||{};var r,i=0,o=[],s=e.length,a=0,c=0,u=n.pre||"",l=n.post||"",f=n.caseSensitive&&e||e.toLowerCase();t=n.caseSensitive&&t||t.toLowerCase();for(var p=0;p<s;p++)r=e[p],f[p]===t[i]?(r=u+r+l,i+=1,c+=1+c):c=0,a+=c,o[o.length]=r;return i===t.length?{rendered:o.join(""),score:a}:null},r.filter=function(t,e,n){return n=n||{},e.reduce(function(e,i,o,s){var a=i;n.extract&&(a=n.extract(i));var c=r.match(t,a,n);return null!=c&&(e[e.length]={string:c.rendered,score:c.score,index:o,original:i}),e},[]).sort(function(t,e){var n=e.score-t.score;return n?n:t.index-e.index})}}()},{}],4:[function(t,e,n){var r=/<%=([\s\S]+?)%>/g;e.exports=r},{}],5:[function(t,e,n){(function(t){function r(t){return t&&t.Object===Object?t:null}var i={"function":!0,object:!0},o=i[typeof n]&&n&&!n.nodeType?n:void 0,s=i[typeof e]&&e&&!e.nodeType?e:void 0,a=r(o&&s&&"object"==typeof t&&t),c=r(i[typeof self]&&self),u=r(i[typeof window]&&window),l=r(i[typeof this]&&this),f=a||u!==(l&&l.window)&&u||c||l||Function("return this")();e.exports=f}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],6:[function(t,e,n){function r(t,e,n){var r=t[e];w.call(t,e)&&u(r,n)&&(void 0!==n||e in t)||(t[e]=n)}function i(t){return function(e){return null==e?void 0:e[t]}}function o(t,e,n,i){n||(n={});for(var o=-1,s=e.length;++o<s;){var a=e[o],c=i?i(n[a],t[a],a,n,t):t[a];r(n,a,c)}return n}function s(t){return y(function(e,n){var r=-1,i=n.length,o=i>1?n[i-1]:void 0,s=i>2?n[2]:void 0;for(o=t.length>3&&"function"==typeof o?(i--,o):void 0,s&&c(n[0],n[1],s)&&(o=i<3?void 0:o,i=1),e=Object(e);++r<i;){var a=n[r];a&&t(e,a,r,o)}return e})}function a(t,e){return e=null==e?v:e,!!e&&("number"==typeof t||b.test(t))&&t>-1&&t%1==0&&t<e}function c(t,e,n){if(!d(n))return!1;var r=typeof e;return!!("number"==r?l(n)&&a(e,n.length):"string"==r&&e in n)&&u(n[e],t)}function u(t,e){return t===e||t!==t&&e!==e}function l(t){return null!=t&&p(E(t))&&!f(t)}function f(t){var e=d(t)?O.call(t):"";return e==g||e==m}function p(t){return"number"==typeof t&&t>-1&&t%1==0&&t<=v}function d(t){var e=typeof t;return!!t&&("object"==e||"function"==e)}var h=t("lodash.keysin"),y=t("lodash.rest"),v=9007199254740991,g="[object Function]",m="[object GeneratorFunction]",b=/^(?:0|[1-9]\d*)$/,_=Object.prototype,w=_.hasOwnProperty,O=_.toString,E=i("length"),x=s(function(t,e,n,r){o(e,h(e),t,r)});e.exports=x},{"lodash.keysin":11,"lodash.rest":12}],7:[function(t,e,n){function r(t,e,n){function r(e){var n=y,r=v;return y=v=void 0,x=e,m=t.apply(r,n)}function i(t){return x=t,b=setTimeout(l,e),j?r(t):m}function s(t){var n=t-_,r=t-x,i=e-n;return I?O(i,g-r):i}function a(t){var n=t-_,r=t-x;return!_||n>=e||n<0||I&&r>=g}function l(){var t=E();return a(t)?f(t):void(b=setTimeout(l,s(t)))}function f(t){return clearTimeout(b),b=void 0,S&&y?r(t):(y=v=void 0,m)}function p(){void 0!==b&&clearTimeout(b),_=x=0,y=v=b=void 0}function d(){return void 0===b?m:f(E())}function h(){var t=E(),n=a(t);if(y=arguments,v=this,_=t,n){if(void 0===b)return i(_);if(I)return clearTimeout(b),b=setTimeout(l,e),r(_)}return void 0===b&&(b=setTimeout(l,e)),m}var y,v,g,m,b,_=0,x=0,j=!1,I=!1,S=!0;if("function"!=typeof t)throw new TypeError(u);return e=c(e)||0,o(n)&&(j=!!n.leading,I="maxWait"in n,g=I?w(c(n.maxWait)||0,e):g,S="trailing"in n?!!n.trailing:S),h.cancel=p,h.flush=d,h}function i(t){var e=o(t)?_.call(t):"";return e==f||e==p}function o(t){var e=typeof t;return!!t&&("object"==e||"function"==e)}function s(t){return!!t&&"object"==typeof t}function a(t){return"symbol"==typeof t||s(t)&&_.call(t)==d}function c(t){if("number"==typeof t)return t;if(a(t))return l;if(o(t)){var e=i(t.valueOf)?t.valueOf():t;t=o(e)?e+"":e}if("string"!=typeof t)return 0===t?t:+t;t=t.replace(h,"");var n=v.test(t);return n||g.test(t)?m(t.slice(2),n?2:8):y.test(t)?l:+t}var u="Expected a function",l=NaN,f="[object Function]",p="[object GeneratorFunction]",d="[object Symbol]",h=/^\s+|\s+$/g,y=/^[-+]0x[0-9a-f]+$/i,v=/^0b[01]+$/i,g=/^0o[0-7]+$/i,m=parseInt,b=Object.prototype,_=b.toString,w=Math.max,O=Math.min,E=Date.now;e.exports=r},{}],8:[function(t,e,n){function r(t){return c[t]}function i(t){return t=o(t),t&&a.test(t)?t.replace(s,r):t}var o=t("lodash.tostring"),s=/[&<>"'`]/g,a=RegExp(s.source),c={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","`":"&#96;"};e.exports=i},{"lodash.tostring":15}],9:[function(t,e,n){function r(t,e){for(var n=-1,r=t.length;++n<r;)if(e(t[n],n,t))return!0;return!1}function i(t){var e=!1;if(null!=t&&"function"!=typeof t.toString)try{e=!!(t+"")}catch(n){}return e}function o(t){var e=-1,n=Array(t.size);return t.forEach(function(t,r){n[++e]=[r,t]}),n}function s(t){var e=-1,n=Array(t.size);return t.forEach(function(t){n[++e]=t}),n}function a(t){var e=-1,n=t?t.length:0;for(this.clear();++e<n;){var r=t[e];this.set(r[0],r[1])}}function c(){this.__data__=Zt?Zt(null):{}}function u(t){return this.has(t)&&delete this.__data__[t]}function l(t){var e=this.__data__;if(Zt){var n=e[t];return n===it?void 0:n}return Gt.call(e,t)?e[t]:void 0}function f(t){var e=this.__data__;return Zt?void 0!==e[t]:Gt.call(e,t)}function p(t,e){var n=this.__data__;return n[t]=Zt&&void 0===e?it:e,this}function d(t){var e=-1,n=t?t.length:0;for(this.clear();++e<n;){var r=t[e];this.set(r[0],r[1])}}function h(){this.__data__=[]}function y(t){var e=this.__data__,n=L(e,t);if(n<0)return!1;var r=e.length-1;return n==r?e.pop():Bt.call(e,n,1),!0}function v(t){var e=this.__data__,n=L(e,t);return n<0?void 0:e[n][1]}function g(t){return L(this.__data__,t)>-1}function m(t,e){var n=this.__data__,r=L(n,t);return r<0?n.push([t,e]):n[r][1]=e,this}function b(t){var e=-1,n=t?t.length:0;for(this.clear();++e<n;){var r=t[e];this.set(r[0],r[1])}}function _(){this.__data__={hash:new a,map:new(Yt||d),string:new a}}function w(t){return G(this,t)["delete"](t)}function O(t){return G(this,t).get(t)}function E(t){return G(this,t).has(t)}function x(t,e){return G(this,t).set(t,e),this}function j(t){var e=-1,n=t?t.length:0;for(this.__data__=new b;++e<n;)this.add(t[e])}function I(t){return this.__data__.set(t,it),this}function S(t){return this.__data__.has(t)}function T(t){this.__data__=new d(t)}function C(){this.__data__=new d}function N(t){return this.__data__["delete"](t)}function R(t){return this.__data__.get(t)}function k(t){return this.__data__.has(t)}function A(t,e){var n=this.__data__;return n instanceof d&&n.__data__.length==rt&&(n=this.__data__=new b(n.__data__)),n.set(t,e),this}function L(t,e){for(var n=t.length;n--;)if(H(t[n][0],e))return n;return-1}function M(t,e){return Gt.call(t,e)||"object"==typeof t&&e in t&&null===Q(t)}function D(t,e,n,r,i){return t===e||(null==t||null==e||!K(t)&&!X(e)?t!==t&&e!==e:P(t,e,D,n,r,i))}function P(t,e,n,r,o,s){var a=ae(t),c=ae(e),u=ut,l=ut;a||(u=W(t),u=u==ct?gt:u),c||(l=W(e),l=l==ct?gt:l);var f=u==gt&&!i(t),p=l==gt&&!i(e),d=u==l;if(d&&!f)return s||(s=new T),a||tt(t)?F(t,e,n,r,o,s):q(t,e,u,n,r,o,s);if(!(o&st)){var h=f&&Gt.call(t,"__wrapped__"),y=p&&Gt.call(e,"__wrapped__");if(h||y){var v=h?t.value():t,g=y?e.value():e;return s||(s=new T),n(v,g,r,o,s)}}return!!d&&(s||(s=new T),U(t,e,n,r,o,s))}function F(t,e,n,i,o,s){var a=o&st,c=t.length,u=e.length;if(c!=u&&!(a&&u>c))return!1;var l=s.get(t);if(l)return l==e;var f=-1,p=!0,d=o&ot?new j:void 0;for(s.set(t,e);++f<c;){var h=t[f],y=e[f];if(i)var v=a?i(y,h,f,e,t,s):i(h,y,f,t,e,s);if(void 0!==v){if(v)continue;p=!1;break}if(d){if(!r(e,function(t,e){if(!d.has(e)&&(h===t||n(h,t,i,o,s)))return d.add(e)})){p=!1;break}}else if(h!==y&&!n(h,y,i,o,s)){p=!1;break}}return s["delete"](t),p}function q(t,e,n,r,i,a,c){switch(n){case jt:if(t.byteLength!=e.byteLength||t.byteOffset!=e.byteOffset)return!1;t=t.buffer,e=e.buffer;case xt:return!(t.byteLength!=e.byteLength||!r(new zt(t),new zt(e)));case lt:case ft:return+t==+e;case pt:return t.name==e.name&&t.message==e.message;case vt:return t!=+t?e!=+e:t==+e;case bt:case wt:return t==e+"";case yt:var u=o;case _t:var l=a&st;if(u||(u=s),t.size!=e.size&&!l)return!1;var f=c.get(t);return f?f==e:(a|=ot,c.set(t,e),F(u(t),u(e),r,i,a,c));case Ot:if(se)return se.call(t)==se.call(e)}return!1}function U(t,e,n,r,i,o){var s=i&st,a=et(t),c=a.length,u=et(e),l=u.length;if(c!=l&&!s)return!1;for(var f=c;f--;){var p=a[f];if(!(s?p in e:M(e,p)))return!1}var d=o.get(t);if(d)return d==e;var h=!0;o.set(t,e);for(var y=s;++f<c;){p=a[f];var v=t[p],g=e[p];if(r)var m=s?r(g,v,p,e,t,o):r(v,g,p,t,e,o);if(!(void 0===m?v===g||n(v,g,r,i,o):m)){h=!1;break}y||(y="constructor"==p)}if(h&&!y){var b=t.constructor,_=e.constructor;b!=_&&"constructor"in t&&"constructor"in e&&!("function"==typeof b&&b instanceof b&&"function"==typeof _&&_ instanceof _)&&(h=!1)}return o["delete"](t),h}function G(t,e){var n=t.__data__;return z(e)?n["string"==typeof e?"string":"hash"]:n.map}function $(t,e){var n=t[e];return Z(n)?n:void 0}function Q(t){return Ht(Object(t))}function W(t){return $t.call(t)}function z(t){var e=typeof t;return"string"==e||"number"==e||"symbol"==e||"boolean"==e?"__proto__"!==t:null===t}function B(t){if(null!=t){try{return Ut.call(t)}catch(e){}try{return t+""}catch(e){}}return""}function H(t,e){return t===e||t!==t&&e!==e}function V(t,e){return D(t,e)}function Y(t){var e=K(t)?$t.call(t):"";return e==dt||e==ht}function J(t){return"number"==typeof t&&t>-1&&t%1==0&&t<=at}function K(t){var e=typeof t;return!!t&&("object"==e||"function"==e)}function X(t){return!!t&&"object"==typeof t}function Z(t){if(!K(t))return!1;var e=Y(t)||i(t)?Qt:Dt;return e.test(B(t))}function tt(t){return X(t)&&J(t.length)&&!!Pt[$t.call(t)]}var et=t("lodash.keys"),nt=t("lodash._root"),rt=200,it="__lodash_hash_undefined__",ot=1,st=2,at=9007199254740991,ct="[object Arguments]",ut="[object Array]",lt="[object Boolean]",ft="[object Date]",pt="[object Error]",dt="[object Function]",ht="[object GeneratorFunction]",yt="[object Map]",vt="[object Number]",gt="[object Object]",mt="[object Promise]",bt="[object RegExp]",_t="[object Set]",wt="[object String]",Ot="[object Symbol]",Et="[object WeakMap]",xt="[object ArrayBuffer]",jt="[object DataView]",It="[object Float32Array]",St="[object Float64Array]",Tt="[object Int8Array]",Ct="[object Int16Array]",Nt="[object Int32Array]",Rt="[object Uint8Array]",kt="[object Uint8ClampedArray]",At="[object Uint16Array]",Lt="[object Uint32Array]",Mt=/[\\^$.*+?()[\]{}|]/g,Dt=/^\[object .+?Constructor\]$/,Pt={};Pt[It]=Pt[St]=Pt[Tt]=Pt[Ct]=Pt[Nt]=Pt[Rt]=Pt[kt]=Pt[At]=Pt[Lt]=!0,Pt[ct]=Pt[ut]=Pt[xt]=Pt[lt]=Pt[jt]=Pt[ft]=Pt[pt]=Pt[dt]=Pt[yt]=Pt[vt]=Pt[gt]=Pt[bt]=Pt[_t]=Pt[wt]=Pt[Et]=!1;var Ft=Array.prototype,qt=Object.prototype,Ut=Function.prototype.toString,Gt=qt.hasOwnProperty,$t=qt.toString,Qt=RegExp("^"+Ut.call(Gt).replace(Mt,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),Wt=nt.Symbol,zt=nt.Uint8Array,Bt=Ft.splice,Ht=Object.getPrototypeOf,Vt=$(nt,"DataView"),Yt=$(nt,"Map"),Jt=$(nt,"Promise"),Kt=$(nt,"Set"),Xt=$(nt,"WeakMap"),Zt=$(Object,"create"),te=B(Vt),ee=B(Yt),ne=B(Jt),re=B(Kt),ie=B(Xt),oe=Wt?Wt.prototype:void 0,se=oe?oe.valueOf:void 0;a.prototype.clear=c,a.prototype["delete"]=u,a.prototype.get=l,a.prototype.has=f,a.prototype.set=p,d.prototype.clear=h,d.prototype["delete"]=y,d.prototype.get=v,d.prototype.has=g,d.prototype.set=m,b.prototype.clear=_,b.prototype["delete"]=w,b.prototype.get=O,b.prototype.has=E,b.prototype.set=x,j.prototype.add=j.prototype.push=I,j.prototype.has=S,T.prototype.clear=C,T.prototype["delete"]=N,T.prototype.get=R,T.prototype.has=k,T.prototype.set=A,(Vt&&W(new Vt(new ArrayBuffer(1)))!=jt||Yt&&W(new Yt)!=yt||Jt&&W(Jt.resolve())!=mt||Kt&&W(new Kt)!=_t||Xt&&W(new Xt)!=Et)&&(W=function(t){var e=$t.call(t),n=e==gt?t.constructor:void 0,r=n?B(n):void 0;if(r)switch(r){case te:return jt;case ee:return yt;case ne:return mt;case re:return _t;case ie:return Et}return e});var ae=Array.isArray;e.exports=V},{"lodash._root":5,"lodash.keys":10}],10:[function(t,e,n){function r(t,e){for(var n=-1,r=Array(t);++n<t;)r[n]=e(n);return r}function i(t,e){return S.call(t,e)||"object"==typeof t&&e in t&&null===a(t)}function o(t){return R(Object(t))}function s(t){return function(e){return null==e?void 0:e[t]}}function a(t){return N(Object(t))}function c(t){var e=t?t.length:void 0;return y(e)&&(A(t)||m(t)||f(t))?r(e,String):null}function u(t,e){return e=null==e?_:e,!!e&&("number"==typeof t||j.test(t))&&t>-1&&t%1==0&&t<e}function l(t){var e=t&&t.constructor,n="function"==typeof e&&e.prototype||I;return t===n}function f(t){return d(t)&&S.call(t,"callee")&&(!C.call(t,"callee")||T.call(t)==w)}function p(t){return null!=t&&y(k(t))&&!h(t)}function d(t){return g(t)&&p(t)}function h(t){var e=v(t)?T.call(t):"";return e==O||e==E}function y(t){return"number"==typeof t&&t>-1&&t%1==0&&t<=_}function v(t){var e=typeof t;return!!t&&("object"==e||"function"==e)}function g(t){return!!t&&"object"==typeof t}function m(t){return"string"==typeof t||!A(t)&&g(t)&&T.call(t)==x}function b(t){var e=l(t);if(!e&&!p(t))return o(t);var n=c(t),r=!!n,s=n||[],a=s.length;for(var f in t)!i(t,f)||r&&("length"==f||u(f,a))||e&&"constructor"==f||s.push(f);return s}var _=9007199254740991,w="[object Arguments]",O="[object Function]",E="[object GeneratorFunction]",x="[object String]",j=/^(?:0|[1-9]\d*)$/,I=Object.prototype,S=I.hasOwnProperty,T=I.toString,C=I.propertyIsEnumerable,N=Object.getPrototypeOf,R=Object.keys,k=s("length"),A=Array.isArray;e.exports=b},{}],11:[function(t,e,n){(function(t){function r(t,e){for(var n=-1,r=Array(t);++n<t;)r[n]=e(n);return r}function i(t){return t&&t.Object===Object?t:null}function o(t){for(var e,n=[];!(e=t.next()).done;)n.push(e.value);return n}function s(t){t=null==t?t:Object(t);var e=[];for(var n in t)e.push(n);return e}function a(t){return function(e){return null==e?void 0:e[t]}}function c(t){var e=t?t.length:void 0;return y(e)&&(G(t)||m(t)||f(t))?r(e,String):null}function u(t,e){return e=null==e?_:e,!!e&&("number"==typeof t||j.test(t))&&t>-1&&t%1==0&&t<e}function l(t){var e=t&&t.constructor,n="function"==typeof e&&e.prototype||L;return t===n}function f(t){return d(t)&&M.call(t,"callee")&&(!q.call(t,"callee")||D.call(t)==w)}function p(t){return null!=t&&y(U(t))&&!h(t)}function d(t){return g(t)&&p(t)}function h(t){var e=v(t)?D.call(t):"";return e==O||e==E}function y(t){return"number"==typeof t&&t>-1&&t%1==0&&t<=_}function v(t){var e=typeof t;return!!t&&("object"==e||"function"==e)}function g(t){return!!t&&"object"==typeof t}function m(t){return"string"==typeof t||!G(t)&&g(t)&&D.call(t)==x}function b(t){for(var e=-1,n=l(t),r=s(t),i=r.length,o=c(t),a=!!o,f=o||[],p=f.length;++e<i;){var d=r[e];a&&("length"==d||u(d,p))||"constructor"==d&&(n||!M.call(t,d))||f.push(d)}return f}var _=9007199254740991,w="[object Arguments]",O="[object Function]",E="[object GeneratorFunction]",x="[object String]",j=/^(?:0|[1-9]\d*)$/,I={"function":!0,object:!0},S=I[typeof n]&&n&&!n.nodeType?n:void 0,T=I[typeof e]&&e&&!e.nodeType?e:void 0,C=i(S&&T&&"object"==typeof t&&t),N=i(I[typeof self]&&self),R=i(I[typeof window]&&window),k=i(I[typeof this]&&this),A=C||R!==(k&&k.window)&&R||N||k||Function("return this")(),L=Object.prototype,M=L.hasOwnProperty,D=L.toString,P=A.Reflect,F=P?P.enumerate:void 0,q=L.propertyIsEnumerable;F&&!q.call({valueOf:1},"valueOf")&&(s=function(t){return o(F(t))});var U=a("length"),G=Array.isArray;e.exports=b}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],12:[function(t,e,n){function r(t,e,n){var r=n.length;switch(r){case 0:return t.call(e);case 1:return t.call(e,n[0]);case 2:return t.call(e,n[0],n[1]);case 3:return t.call(e,n[0],n[1],n[2])}return t.apply(e,n)}function i(t,e){if("function"!=typeof t)throw new TypeError(p);return e=I(void 0===e?t.length-1:l(e),0),function(){for(var n=arguments,i=-1,o=I(n.length-e,0),s=Array(o);++i<o;)s[i]=n[e+i];switch(e){case 0:return t.call(this,s);case 1:return t.call(this,n[0],s);case 2:return t.call(this,n[0],n[1],s)}var a=Array(e+1);for(i=-1;++i<e;)a[i]=n[i];return a[e]=s,r(t,this,a)}}function o(t){var e=s(t)?j.call(t):"";return e==v||e==g}function s(t){var e=typeof t;return!!t&&("object"==e||"function"==e)}function a(t){return!!t&&"object"==typeof t}function c(t){return"symbol"==typeof t||a(t)&&j.call(t)==m}function u(t){if(!t)return 0===t?t:0;if(t=f(t),t===d||t===-d){var e=t<0?-1:1;return e*h}return t===t?t:0}function l(t){var e=u(t),n=e%1;return e===e?n?e-n:e:0}function f(t){if("number"==typeof t)return t;if(c(t))return y;if(s(t)){var e=o(t.valueOf)?t.valueOf():t;t=s(e)?e+"":e}if("string"!=typeof t)return 0===t?t:+t;t=t.replace(b,"");var n=w.test(t);return n||O.test(t)?E(t.slice(2),n?2:8):_.test(t)?y:+t}var p="Expected a function",d=1/0,h=1.7976931348623157e308,y=NaN,v="[object Function]",g="[object GeneratorFunction]",m="[object Symbol]",b=/^\s+|\s+$/g,_=/^[-+]0x[0-9a-f]+$/i,w=/^0b[01]+$/i,O=/^0o[0-7]+$/i,E=parseInt,x=Object.prototype,j=x.toString,I=Math.max;e.exports=i},{}],13:[function(t,e,n){function r(t,e,n){var r=n.length;switch(r){case 0:return t.call(e);case 1:return t.call(e,n[0]);case 2:return t.call(e,n[0],n[1]);case 3:return t.call(e,n[0],n[1],n[2])}return t.apply(e,n)}function i(t,e){for(var n=-1,r=t.length,i=Array(r);++n<r;)i[n]=e(t[n],n,t);return i}function o(t,e){return i(e,function(e){return t[e]})}function s(t){return"\\"+D[t]}function a(t,e,n,r){return void 0===t||f(t,P[n])&&!F.call(r,n)?e:t}function c(t){return function(e){return null==e?void 0:e[t]}}function u(t,e){return e=null==e?j:e,!!e&&("number"==typeof t||A.test(t))&&t>-1&&t%1==0&&t<e}function l(t,e,n){if(!v(n))return!1;var r=typeof e;return!!("number"==r?p(n)&&u(e,n.length):"string"==r&&e in n)&&f(n[e],t)}function f(t,e){return t===e||t!==t&&e!==e}function p(t){return null!=t&&y(U(t))&&!h(t)}function d(t){return!!g(t)&&(q.call(t)==I||"string"==typeof t.message&&"string"==typeof t.name)}function h(t){var e=v(t)?q.call(t):"";return e==S||e==T}function y(t){return"number"==typeof t&&t>-1&&t%1==0&&t<=j}function v(t){var e=typeof t;return!!t&&("object"==e||"function"==e)}function g(t){return!!t&&"object"==typeof t}function m(t,e,n){var r=E.imports._.templateSettings||E;n&&l(t,e,n)&&(e=void 0),t=x(t),e=b({},e,r,a);var i,c,u=b({},e.imports,r.imports,a),f=_(u),p=o(u,f),h=0,y=e.interpolate||L,v="__p += '",g=RegExp((e.escape||L).source+"|"+y.source+"|"+(y===w?k:L).source+"|"+(e.evaluate||L).source+"|$","g"),m="sourceURL"in e?"//# sourceURL="+e.sourceURL+"\n":"";t.replace(g,function(e,n,r,o,a,u){return r||(r=o),v+=t.slice(h,u).replace(M,s),n&&(i=!0,v+="' +\n__e("+n+") +\n'"),a&&(c=!0,v+="';\n"+a+";\n__p += '"),r&&(v+="' +\n((__t = ("+r+")) == null ? '' : __t) +\n'"),h=u+e.length,e}),v+="';\n";var O=e.variable;O||(v="with (obj) {\n"+v+"\n}\n"),v=(c?v.replace(C,""):v).replace(N,"$1").replace(R,"$1;"),v="function("+(O||"obj")+") {\n"+(O?"":"obj || (obj = {});\n")+"var __t, __p = ''"+(i?", __e = _.escape":"")+(c?", __j = Array.prototype.join;\nfunction print() { __p += __j.call(arguments, '') }\n":";\n")+v+"return __p\n}";var j=G(function(){return Function(f,m+"return "+v).apply(void 0,p)});if(j.source=v,d(j))throw j;return j}var b=t("lodash.assigninwith"),_=t("lodash.keys"),w=t("lodash._reinterpolate"),O=t("lodash.rest"),E=t("lodash.templatesettings"),x=t("lodash.tostring"),j=9007199254740991,I="[object Error]",S="[object Function]",T="[object GeneratorFunction]",C=/\b__p \+= '';/g,N=/\b(__p \+=) '' \+/g,R=/(__e\(.*?\)|\b__t\)) \+\n'';/g,k=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,A=/^(?:0|[1-9]\d*)$/,L=/($^)/,M=/['\n\r\u2028\u2029\\]/g,D={"\\":"\\","'":"'","\n":"n","\r":"r","\u2028":"u2028","\u2029":"u2029"},P=Object.prototype,F=P.hasOwnProperty,q=P.toString,U=c("length"),G=O(function(t,e){try{return r(t,void 0,e)}catch(n){return d(n)?n:new Error(n)}});e.exports=m},{"lodash._reinterpolate":4,"lodash.assigninwith":6,"lodash.keys":10,"lodash.rest":12,"lodash.templatesettings":14,"lodash.tostring":15}],14:[function(t,e,n){var r=t("lodash.escape"),i=t("lodash._reinterpolate"),o=/<%-([\s\S]+?)%>/g,s=/<%([\s\S]+?)%>/g,a={escape:o,evaluate:s,interpolate:i,variable:"",imports:{_:{escape:r}}};e.exports=a},{"lodash._reinterpolate":4,"lodash.escape":8}],15:[function(t,e,n){(function(t){function r(t){return t&&t.Object===Object?t:null}function i(t){if("string"==typeof t)return t;if(s(t))return O?O.call(t):"";var e=t+"";return"0"==e&&1/t==-c?"-0":e}function o(t){return!!t&&"object"==typeof t}function s(t){return"symbol"==typeof t||o(t)&&b.call(t)==u}function a(t){return null==t?"":i(t)}var c=1/0,u="[object Symbol]",l={"function":!0,object:!0},f=l[typeof n]&&n&&!n.nodeType?n:void 0,p=l[typeof e]&&e&&!e.nodeType?e:void 0,d=r(f&&p&&"object"==typeof t&&t),h=r(l[typeof self]&&self),y=r(l[typeof window]&&window),v=r(l[typeof this]&&this),g=d||y!==(v&&v.window)&&y||h||v||Function("return this")(),m=Object.prototype,b=m.toString,_=g.Symbol,w=_?_.prototype:void 0,O=w?w.toString:void 0;e.exports=a}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],16:[function(t,e,n){function r(t){return i(Object(t))}var i=Object.getPrototypeOf;e.exports=r},{}],17:[function(t,e,n){function r(t){var e=!1;if(null!=t&&"function"!=typeof t.toString)try{e=!!(t+"")}catch(n){}return e}e.exports=r},{}],18:[function(t,e,n){function r(t){return!!t&&"object"==typeof t}e.exports=r},{}],19:[function(t,e,n){function r(t){if(!s(t)||p.call(t)!=a||o(t))return!1;var e=i(t);if(null===e)return!0;var n=l.call(e,"constructor")&&e.constructor;return"function"==typeof n&&n instanceof n&&u.call(n)==f}var i=t("./_getPrototype"),o=t("./_isHostObject"),s=t("./isObjectLike"),a="[object Object]",c=Object.prototype,u=Function.prototype.toString,l=c.hasOwnProperty,f=u.call(Object),p=c.toString;e.exports=r},{"./_getPrototype":16,"./_isHostObject":17,"./isObjectLike":18}],20:[function(t,e,n){"use strict";function r(t){this._ev=new a,this.options=s({},this.options,t)}if(!mapboxgl)throw new Error("include mapboxgl before mapbox-gl-geocoder.js");var i=t("suggestions"),o=t("lodash.debounce"),s=t("xtend"),a=t("events").EventEmitter,c="https://api.mapbox.com/geocoding/v5/mapbox.places/";r.prototype=mapboxgl.util.inherit(mapboxgl.Control,{options:{position:"top-left",placeholder:"Search",zoom:16,flyTo:!0},onAdd:function(t){this.request=new XMLHttpRequest,this.container=this.options.container?"string"==typeof this.options.container?document.getElementById(this.options.container):this.options.container:t.getContainer();var e=document.createElement("div");e.className="mapboxgl-ctrl-geocoder";var n=document.createElement("span");n.className="geocoder-icon geocoder-icon-search";var r=this._inputEl=document.createElement("input");r.type="text",r.placeholder=this.options.placeholder,r.addEventListener("keydown",o(function(t){return t.target.value?void(t.metaKey||[9,27,37,39,13,38,40].indexOf(t.keyCode)!==-1||this._queryFromInput(t.target.value)):this._clearEl.classList.remove("active")}.bind(this)),200),r.addEventListener("change",function(e){e.target.value&&this._clearEl.classList.add("active");var n=this._typeahead.selected;if(n){if(this.options.flyTo)if(n.bbox&&n.context&&n.context.length<=3||n.bbox&&!n.context){var r=n.bbox;t.fitBounds([[r[0],r[1]],[r[2],r[3]]])}else t.flyTo({center:n.center,zoom:this.options.zoom});this._input=n,this.fire("result",{result:n})}}.bind(this));var s=document.createElement("div");s.classList.add("geocoder-pin-right");var a=this._clearEl=document.createElement("button");a.className="geocoder-icon geocoder-icon-close",a.addEventListener("click",this._clear.bind(this));var c=this._loadingEl=document.createElement("span");return c.className="geocoder-icon geocoder-icon-loading",s.appendChild(a),s.appendChild(c),e.appendChild(n),e.appendChild(r),e.appendChild(s),this.container.appendChild(e),this.options.container&&(this.options.position=!1),this._typeahead=new i(r,[],{filter:!1}),this._typeahead.getItemValue=function(t){return t.place_name},e},_geocode:function(t,e){this._loadingEl.classList.add("active"),this.fire("loading");var n=[];this.options.proximity&&n.push("proximity="+this.options.proximity.join()),this.options.bbox&&n.push("bbox="+this.options.bbox.join()),this.options.country&&n.push("country="+this.options.country),this.options.types&&n.push("types="+this.options.types);var r=this.options.accessToken?this.options.accessToken:mapboxgl.accessToken;n.push("access_token="+r),this.request.abort(),this.request.open("GET",c+encodeURIComponent(t.trim())+".json?"+n.join("&"),!0),this.request.onload=function(){if(this._loadingEl.classList.remove("active"),this.request.status>=200&&this.request.status<400){var t=JSON.parse(this.request.responseText);return t.features.length?this._clearEl.classList.add("active"):(this._clearEl.classList.remove("active"),this._typeahead.selected=null),this.fire("results",{results:t.features}),this._typeahead.update(t.features),e(t.features)}this.fire("error",{error:JSON.parse(this.request.responseText).message})}.bind(this),this.request.onerror=function(){this._loadingEl.classList.remove("active"),this.fire("error",{error:JSON.parse(this.request.responseText).message})}.bind(this),this.request.send()},_queryFromInput:function(t){t=t.trim(),t||this._clear(),t.length>2&&this._geocode(t,function(t){this._results=t}.bind(this))},_change:function(){var t=document.createEvent("HTMLEvents");t.initEvent("change",!0,!1),this._inputEl.dispatchEvent(t)},_query:function(t){t&&("object"==typeof t&&t.length&&(t=[mapboxgl.util.wrap(t[0],-180,180),mapboxgl.util.wrap(t[1],-180,180)].join()),this._geocode(t,function(t){if(t.length){var e=t[0];this._results=t,this._typeahead.selected=e,this._inputEl.value=e.place_name,this._change()}}.bind(this)))},_setInput:function(t){t&&("object"==typeof t&&t.length&&(t=[mapboxgl.util.wrap(t[0],-180,180),mapboxgl.util.wrap(t[1],-180,180)].join()),this._inputEl.value=t,this._input=null,this._typeahead.selected=null,this._typeahead.clear(),this._change())},_clear:function(){this._input=null,this._inputEl.value="",this._typeahead.selected=null,this._typeahead.clear(),this._change(),this._inputEl.focus(),this._clearEl.classList.remove("active"),this.fire("clear")},getResult:function(){return this._input},query:function(t){return this._query(t),this},setInput:function(t){return this._setInput(t),this},on:function(t,e){return this._ev.on(t,e),this},fire:function(t,e){return this._ev.emit(t,e),this},off:function(t,e){return this._ev.removeListener(t,e),this}}),window.mapboxgl?mapboxgl.Geocoder=r:"undefined"!=typeof e&&(e.exports=r)},{events:2,"lodash.debounce":7,suggestions:30,xtend:37}],21:[function(t,e,n){"use strict";function r(t,e){t=Math.round(t*e),t<<=1,t<0&&(t=~t);for(var n="";t>=32;)n+=String.fromCharCode((32|31&t)+63),t>>=5;return n+=String.fromCharCode(t+63)}function i(t){for(var e=[],n=0;n<t.length;n++)e.push(t[n].slice().reverse());return e}var o={};o.decode=function(t,e){for(var n,r,i=0,o=0,s=0,a=[],c=0,u=0,l=null,f=Math.pow(10,e||5);i<t.length;){l=null,c=0,u=0;do l=t.charCodeAt(i++)-63,u|=(31&l)<<c,c+=5;while(l>=32);n=1&u?~(u>>1):u>>1,c=u=0;do l=t.charCodeAt(i++)-63,u|=(31&l)<<c,c+=5;while(l>=32);r=1&u?~(u>>1):u>>1,o+=n,s+=r,a.push([o/f,s/f])}return a},o.encode=function(t,e){if(!t.length)return"";for(var n=Math.pow(10,e||5),i=r(t[0][0],n)+r(t[0][1],n),o=1;o<t.length;o++){var s=t[o],a=t[o-1];i+=r(s[0]-a[0],n),i+=r(s[1]-a[1],n)}return i},o.fromGeoJSON=function(t,e){if(t&&"Feature"===t.type&&(t=t.geometry),!t||"LineString"!==t.type)throw new Error("Input must be a GeoJSON LineString");return o.encode(i(t.coordinates),e)},o.toGeoJSON=function(t,e){var n=o.decode(t,e);return{type:"LineString",coordinates:i(n)
}},"object"==typeof e&&e.exports&&(e.exports=o)},{}],22:[function(t,e,n){"use strict";function r(t){return function(e){var n=e.dispatch,r=e.getState;return function(e){return function(i){return"function"==typeof i?i(n,r,t):e(i)}}}}n.__esModule=!0;var i=r();i.withExtraArgument=r,n["default"]=i},{}],23:[function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{"default":t}}function i(){for(var t=arguments.length,e=Array(t),n=0;n<t;n++)e[n]=arguments[n];return function(t){return function(n,r,i){var s=t(n,r,i),c=s.dispatch,u=[],l={getState:s.getState,dispatch:function(t){return c(t)}};return u=e.map(function(t){return t(l)}),c=a["default"].apply(void 0,u)(s.dispatch),o({},s,{dispatch:c})}}}n.__esModule=!0;var o=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t};n["default"]=i;var s=t("./compose"),a=r(s)},{"./compose":26}],24:[function(t,e,n){"use strict";function r(t,e){return function(){return e(t.apply(void 0,arguments))}}function i(t,e){if("function"==typeof t)return r(t,e);if("object"!=typeof t||null===t)throw new Error("bindActionCreators expected an object or a function, instead received "+(null===t?"null":typeof t)+'. Did you write "import ActionCreators from" instead of "import * as ActionCreators from"?');for(var n=Object.keys(t),i={},o=0;o<n.length;o++){var s=n[o],a=t[s];"function"==typeof a&&(i[s]=r(a,e))}return i}n.__esModule=!0,n["default"]=i},{}],25:[function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{"default":t}}function i(t,e){var n=e&&e.type,r=n&&'"'+n.toString()+'"'||"an action";return"Given action "+r+', reducer "'+t+'" returned undefined. To ignore an action, you must explicitly return the previous state.'}function o(t){Object.keys(t).forEach(function(e){var n=t[e],r=n(void 0,{type:a.ActionTypes.INIT});if("undefined"==typeof r)throw new Error('Reducer "'+e+'" returned undefined during initialization. If the state passed to the reducer is undefined, you must explicitly return the initial state. The initial state may not be undefined.');var i="@@redux/PROBE_UNKNOWN_ACTION_"+Math.random().toString(36).substring(7).split("").join(".");if("undefined"==typeof n(void 0,{type:i}))throw new Error('Reducer "'+e+'" returned undefined when probed with a random type. '+("Don't try to handle "+a.ActionTypes.INIT+' or other actions in "redux/*" ')+"namespace. They are considered private. Instead, you must return the current state for any unknown actions, unless it is undefined, in which case you must return the initial state, regardless of the action type. The initial state may not be undefined.")})}function s(t){for(var e=Object.keys(t),n={},r=0;r<e.length;r++){var s=e[r];"function"==typeof t[s]&&(n[s]=t[s])}var a,c=Object.keys(n);try{o(n)}catch(u){a=u}return function(){var t=arguments.length<=0||void 0===arguments[0]?{}:arguments[0],e=arguments[1];if(a)throw a;for(var r=!1,o={},s=0;s<c.length;s++){var u=c[s],l=n[u],f=t[u],p=l(f,e);if("undefined"==typeof p){var d=i(u,e);throw new Error(d)}o[u]=p,r=r||p!==f}return r?o:t}}n.__esModule=!0,n["default"]=s;var a=t("./createStore"),c=t("lodash/isPlainObject"),u=(r(c),t("./utils/warning"));r(u)},{"./createStore":27,"./utils/warning":29,"lodash/isPlainObject":19}],26:[function(t,e,n){"use strict";function r(){for(var t=arguments.length,e=Array(t),n=0;n<t;n++)e[n]=arguments[n];if(0===e.length)return function(t){return t};var r=function(){var t=e[e.length-1],n=e.slice(0,-1);return{v:function(){return n.reduceRight(function(t,e){return e(t)},t.apply(void 0,arguments))}}}();return"object"==typeof r?r.v:void 0}n.__esModule=!0,n["default"]=r},{}],27:[function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{"default":t}}function i(t,e,n){function r(){g===v&&(g=v.slice())}function o(){return y}function a(t){if("function"!=typeof t)throw new Error("Expected listener to be a function.");var e=!0;return r(),g.push(t),function(){if(e){e=!1,r();var n=g.indexOf(t);g.splice(n,1)}}}function l(t){if(!(0,s["default"])(t))throw new Error("Actions must be plain objects. Use custom middleware for async actions.");if("undefined"==typeof t.type)throw new Error('Actions may not have an undefined "type" property. Have you misspelled a constant?');if(m)throw new Error("Reducers may not dispatch actions.");try{m=!0,y=h(y,t)}finally{m=!1}for(var e=v=g,n=0;n<e.length;n++)e[n]();return t}function f(t){if("function"!=typeof t)throw new Error("Expected the nextReducer to be a function.");h=t,l({type:u.INIT})}function p(){var t,e=a;return t={subscribe:function(t){function n(){t.next&&t.next(o())}if("object"!=typeof t)throw new TypeError("Expected the observer to be an object.");n();var r=e(n);return{unsubscribe:r}}},t[c["default"]]=function(){return this},t}var d;if("function"==typeof e&&"undefined"==typeof n&&(n=e,e=void 0),"undefined"!=typeof n){if("function"!=typeof n)throw new Error("Expected the enhancer to be a function.");return n(i)(t,e)}if("function"!=typeof t)throw new Error("Expected the reducer to be a function.");var h=t,y=e,v=[],g=v,m=!1;return l({type:u.INIT}),d={dispatch:l,subscribe:a,getState:o,replaceReducer:f},d[c["default"]]=p,d}n.__esModule=!0,n.ActionTypes=void 0,n["default"]=i;var o=t("lodash/isPlainObject"),s=r(o),a=t("symbol-observable"),c=r(a),u=n.ActionTypes={INIT:"@@redux/INIT"}},{"lodash/isPlainObject":19,"symbol-observable":33}],28:[function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{"default":t}}n.__esModule=!0,n.compose=n.applyMiddleware=n.bindActionCreators=n.combineReducers=n.createStore=void 0;var i=t("./createStore"),o=r(i),s=t("./combineReducers"),a=r(s),c=t("./bindActionCreators"),u=r(c),l=t("./applyMiddleware"),f=r(l),p=t("./compose"),d=r(p),h=t("./utils/warning");r(h);n.createStore=o["default"],n.combineReducers=a["default"],n.bindActionCreators=u["default"],n.applyMiddleware=f["default"],n.compose=d["default"]},{"./applyMiddleware":23,"./bindActionCreators":24,"./combineReducers":25,"./compose":26,"./createStore":27,"./utils/warning":29}],29:[function(t,e,n){"use strict";function r(t){"undefined"!=typeof console&&"function"==typeof console.error&&console.error(t);try{throw new Error(t)}catch(e){}}n.__esModule=!0,n["default"]=r},{}],30:[function(t,e,n){"use strict";var r=t("./src/suggestions");window.Suggestions=e.exports=r},{"./src/suggestions":32}],31:[function(t,e,n){"Use strict";var r=function(t){return this.component=t,this.items=[],this.active=0,this.element=document.createElement("ul"),this.element.className="suggestions",t.el.parentNode.insertBefore(this.element,t.el.nextSibling),this};r.prototype.show=function(){this.element.style.display="block"},r.prototype.hide=function(){this.element.style.display="none"},r.prototype.add=function(t){this.items.push(t)},r.prototype.clear=function(){this.items=[],this.active=0},r.prototype.isEmpty=function(){return!this.items.length},r.prototype.draw=function(){if(this.element.innerHTML="",0===this.items.length)return void this.hide();for(var t=0;t<this.items.length;t++)this.drawItem(this.items[t],this.active===t);this.show()},r.prototype.drawItem=function(t,e){var n=document.createElement("li"),r=document.createElement("a");e&&(n.className+=" active"),r.innerHTML=t.string,n.appendChild(r),this.element.appendChild(n),n.addEventListener("mousedown",function(){this.handleMouseDown.call(this,t)}.bind(this))},r.prototype.handleMouseDown=function(t){this.component.value(t.original),this.clear(),this.draw()},r.prototype.move=function(t){this.active=t,this.draw()},r.prototype.previous=function(){this.move(0===this.active?this.items.length-1:this.active-1)},r.prototype.next=function(){this.move(this.active===this.items.length-1?0:this.active+1)},e.exports=r},{}],32:[function(t,e,n){"use strict";var r=t("xtend"),i=t("fuzzy"),o=t("./list"),s=function(t,e,n){return n=n||{},this.options=r({minLength:2,limit:5,filter:!0},n),this.el=t,this.data=e||[],this.list=new o(this),this.query="",this.selected=null,this.list.draw(),this.el.addEventListener("keyup",function(t){this.handleKeyUp(t.keyCode)}.bind(this),!1),this.el.addEventListener("keydown",function(t){this.handleKeyDown(t)}.bind(this)),this.el.addEventListener("focus",function(){this.handleFocus()}.bind(this)),this.el.addEventListener("blur",function(){this.handleBlur()}.bind(this)),this};s.prototype.handleKeyUp=function(t){if(40!==t&&38!==t&&27!==t&&13!==t&&9!==t)return this.query=this.normalize(this.el.value),this.list.clear(),this.query.length<this.options.minLength?void this.list.draw():void this.getCandidates(function(t){for(var e=0;e<t.length&&(this.list.add(t[e]),e!==this.options.limit-1);e++);this.list.draw()}.bind(this))},s.prototype.handleKeyDown=function(t){switch(t.keyCode){case 13:case 9:this.list.isEmpty()||(this.value(this.list.items[this.list.active].original),this.list.hide());break;case 27:this.list.isEmpty()||this.list.hide();break;case 38:this.list.previous();break;case 40:this.list.next()}},s.prototype.handleBlur=function(){this.list.hide()},s.prototype.handleFocus=function(){this.list.isEmpty()||this.list.show()},s.prototype.update=function(t){this.data=t,this.list.draw()},s.prototype.clear=function(){this.data=[],this.list.clear()},s.prototype.normalize=function(t){return t=t.toLowerCase()},s.prototype.match=function(t,e){return t.indexOf(e)>-1},s.prototype.value=function(t){if(this.selected=t,this.el.value=this.getItemValue(t),document.createEvent){var e=document.createEvent("HTMLEvents");e.initEvent("change",!0,!1),this.el.dispatchEvent(e)}else this.el.fireEvent("onchange")},s.prototype.getCandidates=function(t){var e={pre:"<strong>",post:"</strong>",extract:function(t){return this.getItemValue(t)}.bind(this)},n=this.options.filter?i.filter(this.query,this.data,e):this.data.map(function(t){return{original:t,string:this.getItemValue(t).replace(new RegExp("("+this.query+")","ig"),function(t,e){return"<strong>"+e+"</strong>"})}}.bind(this));t(n)},s.prototype.getItemValue=function(t){return t},e.exports=s},{"./list":31,fuzzy:3,xtend:37}],33:[function(t,e,n){(function(n){"use strict";e.exports=t("./ponyfill")(n||window||this)}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./ponyfill":34}],34:[function(t,e,n){"use strict";e.exports=function(t){var e,n=t.Symbol;return"function"==typeof n?n.observable?e=n.observable:(e=n("observable"),n.observable=e):e="@@observable",e}},{}],35:[function(t,e,n){var r=t("turf-meta").coordEach;e.exports=function(t){var e=[1/0,1/0,-(1/0),-(1/0)];return r(t,function(t){e[0]>t[0]&&(e[0]=t[0]),e[1]>t[1]&&(e[1]=t[1]),e[2]<t[0]&&(e[2]=t[0]),e[3]<t[1]&&(e[3]=t[1])}),e}},{"turf-meta":36}],36:[function(t,e,n){function r(t,e,n){var r,i,o,s,a,c,u,f,p,d=0,h="FeatureCollection"===t.type,y="Feature"===t.type,v=h?t.features.length:1;for(r=0;r<v;r++)for(f=h?t.features[r].geometry:y?t.geometry:t,p="GeometryCollection"===f.type,c=p?f.geometries.length:1,s=0;s<c;s++)if(a=p?f.geometries[s]:f,u=a.coordinates,d=!n||"Polygon"!==a.type&&"MultiPolygon"!==a.type?0:1,"Point"===a.type)e(u);else if("LineString"===a.type||"MultiPoint"===a.type)for(i=0;i<u.length;i++)e(u[i]);else if("Polygon"===a.type||"MultiLineString"===a.type)for(i=0;i<u.length;i++)for(o=0;o<u[i].length-d;o++)e(u[i][o]);else{if("MultiPolygon"!==a.type)throw new Error("Unknown Geometry Type");for(i=0;i<u.length;i++)for(o=0;o<u[i].length;o++)for(l=0;l<u[i][o].length-d;l++)e(u[i][o][l])}}function i(t,e,n,i){return r(t,function(t){n=e(n,t)},i),n}function o(t,e){var n;switch(t.type){case"FeatureCollection":for(features=t.features,n=0;n<t.features.length;n++)e(t.features[n].properties);break;case"Feature":e(t.properties)}}function s(t,e,n){return o(t,function(t){n=e(n,t)}),n}e.exports.coordEach=r,e.exports.coordReduce=i,e.exports.propEach=o,e.exports.propReduce=s},{}],37:[function(t,e,n){function r(){for(var t={},e=0;e<arguments.length;e++){var n=arguments[e];for(var r in n)i.call(n,r)&&(t[r]=n[r])}return t}e.exports=r;var i=Object.prototype.hasOwnProperty},{}],38:[function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{"default":t}}function i(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e["default"]=t,e}function o(t){return function(e){var n=P["default"].createPoint(t,{id:"origin","marker-symbol":"A"});e({type:M.ORIGIN,origin:n}),e(A("origin",{feature:n}))}}function s(t){return function(e){var n=P["default"].createPoint(t,{id:"destination","marker-symbol":"B"});e({type:M.DESTINATION,destination:n}),e(A("destination",{feature:n}))}}function a(t){return function(e){e({type:M.DIRECTIONS,directions:t}),e(A("route",{route:t}))}}function c(t){return{type:M.WAYPOINTS,waypoints:t}}function u(t){return{type:M.HOVER_MARKER,hoverMarker:t}}function l(){var t=this;return function(e,n){var r=n(),i=(r.api,r.accessToken),c=r.routeIndex,u=(r.profile,f(n),{geometry:"polyline",instructions:"text",alternatives:!0,steps:!0});u.access_token=i?i:mapboxgl.accessToken,F.abort(),F.open("GET",API+encodeURIComponent(q.trim())+".json?"+u.join("&"),!0),F.onload=function(){if(t._loadingEl.classList.remove("active"),!(F.status>=200&&F.status<400))return e(a([])),e(d(JSON.parse(F.responseText).message));JSON.parse(F.responseText);e(d(null)),F.routes[c]||e(O(0)),e(a(F.routes)),e(o(F.origin.geometry.coordinates)),e(s(F.destination.geometry.coordinates))},F.onerror=function(){return e(a([])),e(d(JSON.parse(F.responseText).message))},F.send()}}function f(t){var e=t(),n=e.origin,r=e.destination,i=e.waypoints,o=[];return o=o.concat(n.geometry.coordinates),o.push(";"),i.length&&i.forEach(function(t){o=o.concat(t.geometry.coordinates),o.push(";")}),o=o.concat(r.geometry.coordinates),encodeURIComponent(o.join())}function p(t){var e={id:"waypoint"};return Object.assign(t,{properties:t.properties?Object.assign(t.properties,e):e})}function d(t){return function(e){e({type:"ERROR",error:t}),t&&e(A("error",{error:t}))}}function h(t){return{type:M.ORIGIN_QUERY,query:t}}function y(t){return{type:M.DESTINATION_QUERY,query:t}}function v(t){return{type:M.ORIGIN_FROM_COORDINATES,coordinates:t}}function g(t){return{type:M.DESTINATION_FROM_COORDINATES,coordinates:t}}function m(){return function(t){t({type:M.ORIGIN_CLEAR}),t(A("clear",{type:"origin"})),t(d(null))}}function b(){return function(t){t({type:M.DESTINATION_CLEAR}),t(A("clear",{type:"destination"})),t(d(null))}}function _(t){return{type:M.SET_OPTIONS,options:t}}function w(t){return function(e){var n=t?P["default"].createPoint(t,{id:"hover"}):{};e(u(n))}}function O(t){return{type:M.ROUTE_INDEX,routeIndex:t}}function E(t){return function(e,n){var r=n(),i=r.destination;e(o(t)),i.geometry&&e(l())}}function x(t){return function(e,n){var r=n(),i=r.origin;e(s(t)),i.geometry&&e(l())}}function j(t){return function(e,n){var r=n(),i=r.origin,o=r.destination;e({type:M.DIRECTIONS_PROFILE,profile:t}),e(A("profile",{profile:t})),i.geometry&&o.geometry&&e(l())}}function I(){return function(t,e){var n=e();n.destination.geometry&&t(o(n.destination.geometry.coordinates)),n.origin.geometry&&t(s(n.origin.geometry.coordinates)),n.origin.geometry&&n.destination.geometry&&t(l())}}function S(t){return function(e){return P["default"].validCoords(t)||(t=[P["default"].wrap(t[0]),P["default"].wrap(t[1])]),isNaN(t[0])&&isNaN(t[1])?e(d(new Error("Coordinates are not valid"))):(e(v(t)),void e(E(t)))}}function T(t){return function(e){return P["default"].validCoords(t)||(t=[P["default"].wrap(t[0]),P["default"].wrap(t[1])]),isNaN(t[0])&&isNaN(t[1])?e(d(new Error("Coordinates are not valid"))):(e(x(t)),void e(g(t)))}}function C(t,e){return function(n,r){var i=r(),o=i.destination,s=i.waypoints;s.splice(t,0,p(e)),n(c(s)),o.geometry&&n(l())}}function N(t,e){return function(n,r){var i=r(),o=i.destination,s=i.waypoints;s[t]=p(e),n(c(s)),o.geometry&&n(l())}}function R(t){return function(e,n){var r=n(),i=r.destination,o=r.waypoints;o=o.filter(function(e){return!P["default"].coordinateMatch(e,t)}),e(c(o)),i.geometry&&e(l())}}function k(t,e){return function(n,r){var i=r(),o=i.events;return o[t]=o[t]||[],o[t].push(e),{type:M.EVENTS,events:o}}}function A(t,e){var n=this;return function(r,i){var o=i(),s=o.events;if(!s[t])return{type:M.EVENTS,events:s};for(var a=s[t].slice(),c=0;c<a.length;c++)a[c].call(n,e)}}Object.defineProperty(n,"__esModule",{value:!0}),n.queryOrigin=h,n.queryDestination=y,n.queryOriginCoordinates=v,n.queryDestinationCoordinates=g,n.clearOrigin=m,n.clearDestination=b,n.setOptions=_,n.hoverMarker=w,n.setRouteIndex=O,n.createOrigin=E,n.createDestination=x,n.setProfile=j,n.reverse=I,n.setOriginFromCoordinates=S,n.setDestinationFromCoordinates=T,n.addWaypoint=C,n.setWaypoint=N,n.removeWaypoint=R,n.eventSubscribe=k,n.eventEmit=A;var L=t("../constants/action_types"),M=i(L),D=t("../utils"),P=r(D),F=new XMLHttpRequest},{"../constants/action_types":39,"../utils":45}],39:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});n.DESTINATION="DESTINATION",n.DESTINATION_CLEAR="DESTINATION_CLEAR",n.DESTINATION_QUERY="DESTINATION_QUERY",n.DESTINATION_FROM_COORDINATES="DESTINATION_FROM_COORDINATES",n.DIRECTIONS="DIRECTIONS",n.DIRECTIONS_PROFILE="DIRECTIONS_PROFILE",n.EVENTS="EVENTS",n.ERROR="ERROR",n.HOVER_MARKER="HOVER_MARKER",n.ORIGIN="ORIGIN",n.ORIGIN_CLEAR="ORIGIN_CLEAR",n.ORIGIN_QUERY="ORIGIN_QUERY",n.ORIGIN_FROM_COORDINATES="ORIGIN_FROM_COORDINATES",n.ROUTE_INDEX="ROUTE_INDEX",n.SET_OPTIONS="SET_OPTIONS",n.WAYPOINTS="WAYPOINTS"},{}],40:[function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{"default":t}}function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(n,"__esModule",{value:!0});var o=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}();t("mapbox-gl-geocoder");var s=t("lodash.template"),a=r(s),c=t("lodash.isequal"),u=r(c),l=t("turf-extent"),f=r(l),p=(0,a["default"])("<div class='mapbox-directions-component mapbox-directions-inputs'>\n  <div class='mapbox-directions-component-keyline'>\n    <div class='mapbox-directions-origin'>\n      <label class='mapbox-form-label'>\n        <span class='directions-icon directions-icon-depart'></span>\n      </label>\n      <div id='mapbox-directions-origin-input'></div>\n    </div>\n\n    <button\n      class='directions-icon directions-icon-reverse directions-reverse js-reverse-inputs'\n      title='Reverse origin &amp; destination'>\n    </button>\n\n    <div class='mapbox-directions-destination'>\n      <label class='mapbox-form-label'>\n        <span class='directions-icon directions-icon-arrive'></span>\n      </label>\n      <div id='mapbox-directions-destination-input'></div>\n    </div>\n  </div>\n\n  <div class='mapbox-directions-profile mapbox-directions-component-keyline mapbox-directions-clearfix'>\n    <input\n      id='mapbox-directions-profile-driving'\n      type='radio'\n      name='profile'\n      <% if (profile === 'driving') { %>checked<% } %>\n    />\n    <label for='mapbox-directions-profile-driving'>Driving</label>\n    <input\n      id='mapbox-directions-profile-walking'\n      type='radio'\n      name='profile'\n      <% if (profile === 'walking') { %>checked<% } %>\n    />\n    <label for='mapbox-directions-profile-walking'>Walking</label>\n    <input\n      id='mapbox-directions-profile-cycling'\n      type='radio'\n      name='profile'\n      <% if (profile === 'cycling') { %>checked<% } %>\n    />\n    <label for='mapbox-directions-profile-cycling'>Cycling</label>\n  </div>\n</div>\n"),d=function(){function t(e,n,r,o){i(this,t);var s=n.getState(),a=s.originQuery,c=s.destinationQuery,u=s.profile;e.innerHTML=p({originQuery:a,destinationQuery:c,profile:u}),this.container=e,this.actions=r,this.store=n,this.map=o,this.onAdd(),this.render()}return o(t,[{key:"animateToCoordinates",value:function(t,e){var n=this.store.getState(),r=n.origin,i=n.destination;if(r.geometry&&i.geometry&&!(0,u["default"])(r.geometry,i.geometry)){var o=(0,f["default"])({type:"FeatureCollection",features:[r,i]});this.map.fitBounds([[o[0],o[1]],[o[2],o[3]]],{padding:80})}else this.map.flyTo({center:e})}},{key:"onAdd",value:function(){var t=this,e=this.actions,n=e.clearOrigin,r=e.clearDestination,i=e.createOrigin,o=e.createDestination,s=e.setProfile,a=e.reverse;this.originInput=new mapboxgl.Geocoder({flyTo:!1,placeholder:"Choose a starting place",container:this.container.querySelector("#mapbox-directions-origin-input")}),this.map.addControl(this.originInput),this.destinationInput=new mapboxgl.Geocoder({flyTo:!1,placeholder:"Choose destination",container:this.container.querySelector("#mapbox-directions-destination-input")}),this.map.addControl(this.destinationInput),this.originInput.on("result",function(e){var n=e.result.center;i(n),t.animateToCoordinates("origin",n)}),this.originInput.on("clear",n),this.destinationInput.on("result",function(e){var n=e.result.center;o(n),t.animateToCoordinates("destination",n)}),this.destinationInput.on("clear",r);var c=this.container.querySelectorAll('input[type="radio"]');Array.prototype.forEach.call(c,function(t){t.addEventListener("change",function(){s(t.id.split("-").pop())})}),this.container.querySelector(".js-reverse-inputs").addEventListener("click",function(){var e=t.store.getState(),n=e.origin,r=e.destination;n&&t.actions.queryDestination(n.geometry.coordinates),r&&t.actions.queryOrigin(r.geometry.coordinates),a()})}},{key:"render",value:function(){var t=this;this.store.subscribe(function(){var e=t.store.getState(),n=e.originQuery,r=e.destinationQuery,i=e.originQueryCoordinates,o=e.destinationQueryCoordinates;n&&(t.originInput.query(n),t.actions.queryOrigin(null)),r&&(t.destinationInput.query(r),t.actions.queryDestination(null)),i&&(t.originInput.setInput(i),t.animateToCoordinates("origin",i),t.actions.queryOriginCoordinates(null)),o&&(t.destinationInput.setInput(o),t.animateToCoordinates("destination",o),t.actions.queryDestinationCoordinates(null))})}}]),t}();n["default"]=d},{"lodash.isequal":9,"lodash.template":13,"mapbox-gl-geocoder":20,"turf-extent":35}],41:[function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{"default":t}}function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(n,"__esModule",{value:!0});var o=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),s=t("../utils"),a=r(s),c=t("lodash.template"),u=r(c),l=t("lodash.isequal"),f=r(l),p=(0,u["default"])("<div class='directions-control directions-control-directions'>\n  <div class='mapbox-directions-component mapbox-directions-route-summary<% if (routes > 1) { %> mapbox-directions-multiple<% } %>'>\n    <% if (routes > 1) { %>\n    <div class='mapbox-directions-routes mapbox-directions-clearfix'>\n      <% for (var i = 0; i < routes; i++) { %>\n        <input type='radio' name='routes' id='<%= i %>' <% if (i === routeIndex) { %>checked<% } %>>\n        <label for='<%= i %>' class='mapbox-directions-route'><%= i + 1 %></label>\n      <% } %>\n    </div>\n    <% } %>\n    <h1><%- duration %></h1>\n    <span><%- distance %></span>\n  </div>\n\n  <div class='mapbox-directions-instructions'>\n    <ol class='mapbox-directions-steps'>\n      <% steps.forEach(function(step) { %>\n        <%\n          var distance = step.distance ? format(step.distance) : false;\n          var icon = step.maneuver.type.replace(/\\s+/g, '-').toLowerCase();\n          var lng = step.maneuver.location.coordinates[0];\n          var lat = step.maneuver.location.coordinates[1];\n        %>\n        <li\n          data-lat='<%= lat %>'\n          data-lng='<%= lng %>'\n          class='mapbox-directions-step'>\n          <span class='directions-icon directions-icon-<%= icon %>'></span>\n          <div class='mapbox-directions-step-maneuver'>\n            <%= step.maneuver.instruction %>\n          </div>\n          <% if (step.distance) { %>\n            <div class='mapbox-directions-step-distance'>\n              <%= distance %>\n            </div>\n          <% } %>\n        </li>\n      <% }); %>\n    </ol>\n  </div>\n</div>\n"),d=(0,u["default"])("<div class='directions-control directions-control-directions'>\n  <div class='mapbox-directions-error'>\n    <%= error %>\n  </div>\n</div>\n"),h=function(){function t(e,n,r,o){i(this,t),this.container=e,this.actions=r,this.store=n,this.map=o,this.directions={},this.render()}return o(t,[{key:"render",value:function(){var t=this;this.store.subscribe(function(){var e=t.actions,n=e.hoverMarker,r=e.setRouteIndex,i=t.store.getState(),o=i.routeIndex,s=i.unit,c=i.directions,u=i.error,l=!(0,f["default"])(c[o],t.directions);if(u)return void(t.container.innerHTML=d({error:u}));if(c.length&&l){var h=t.directions=c[o];t.container.innerHTML=p({routeIndex:o,routes:c.length,steps:h.steps,format:a["default"].format[s],duration:a["default"].format[s](h.distance),distance:a["default"].format.duration(h.duration)});var y=t.container.querySelectorAll(".mapbox-directions-step");Array.prototype.forEach.call(y,function(e){var r=e.getAttribute("data-lng"),i=e.getAttribute("data-lat");e.addEventListener("mouseover",function(){n([r,i])}),e.addEventListener("mouseout",function(){n(null)}),e.addEventListener("click",function(){t.map.flyTo({center:[r,i],zoom:16})})});var v=t.container.querySelectorAll('input[type="radio"]');Array.prototype.forEach.call(v,function(t){t.addEventListener("change",function(t){r(parseInt(t.target.id,10))})})}else t.container.innerHTML&&l&&(t.container.innerHTML="")})}}]),t}();n["default"]=h},{"../utils":45,"lodash.isequal":9,"lodash.template":13}],42:[function(t,e,n){"use strict";function r(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e["default"]=t,e}function i(t){return t&&t.__esModule?t:{"default":t}}function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function s(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(n,"__esModule",{value:!0});var c=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),u=t("redux"),l=t("redux-thunk"),f=i(l),p=t("polyline"),d=t("./utils"),h=i(d),y=t("./reducers"),v=i(y),g=t("./actions"),m=r(g),b=t("./directions_style"),_=i(b),w=t("./controls/inputs"),O=i(w),E=t("./controls/instructions"),x=i(E);if(!mapboxgl)throw new Error("include mapboxgl before mapbox-gl-directions.js");var j=(0,u.applyMiddleware)(f["default"])(u.createStore),I=j(v["default"]),S=function(t){function e(t){o(this,e);var n=s(this,Object.getPrototypeOf(e).call(this));return n.actions=(0,u.bindActionCreators)(m,I.dispatch),n.actions.setOptions(t||{}),n.onDragDown=n._onDragDown.bind(n),n.onDragMove=n._onDragMove.bind(n),n.onDragUp=n._onDragUp.bind(n),n.move=n._move.bind(n),n.onClick=n._onClick.bind(n),n}return a(e,t),c(e,[{key:"onAdd",value:function(t){var e=this;this.map=t;var n=I.getState(),r=n.container,i=n.controls;this.container=r?"string"==typeof r?document.getElementById(r):r:this.map.getContainer();var o=document.createElement("div");o.className="directions-control directions-control-inputs",new O["default"](o,I,this.actions,this.map);var s=document.createElement("div");s.className="directions-control-directions-container",new x["default"](s,I,{hoverMarker:this.actions.hoverMarker,setRouteIndex:this.actions.setRouteIndex},this.map),i.inputs&&this.container.appendChild(o),i.instructions&&this.container.appendChild(s),this.subscribedActions(),this.map.on("style.load",function(){return e.mapState()})}},{key:"mapState",value:function(){var t=this,e=I.getState(),n=e.profile,r=e.styles,i=e.interactive;this.actions.eventEmit("profile",{profile:n});var o=new mapboxgl.GeoJSONSource({data:{type:"FeatureCollection",features:[]}});this.map.addSource("directions",o),_["default"].forEach(function(e){return t.map.addLayer(e)}),r&&r.length&&r.forEach(function(e){return t.map.addLayer(e)}),i&&(this.map.on("mousedown",this.onDragDown),this.map.on("mousemove",this.move),this.map.on("click",this.onClick),this.map.on("touchstart",this.move),this.map.on("touchstart",this.onDragDown))}},{key:"subscribedActions",value:function(){var t=this;I.subscribe(function(){var e=I.getState(),n=e.origin,r=e.destination,i=e.hoverMarker,o=e.directions,s=e.routeIndex,a={type:"FeatureCollection",features:[n,r,i].filter(function(t){return t.geometry})};o.length&&o.forEach(function(t,e){var n={geometry:{type:"LineString",coordinates:(0,p.decode)(t.geometry,6).map(function(t){return t.reverse()})},properties:{"route-index":e,route:e===s?"selected":"alternate"}};a.features.push(n),e===s&&t.steps.forEach(function(t){"waypoint"===t.maneuver.type&&a.features.push({type:"Feature",geometry:t.maneuver.location,properties:{id:"waypoint"}})})}),t.map.style&&t.map.getSource("directions").setData(a)})}},{key:"_onClick",value:function(t){var e=this,n=I.getState(),r=n.origin,i=[t.lngLat.lng,t.lngLat.lat];if(r.geometry){var o=this.map.queryRenderedFeatures(t.point,{layers:["directions-origin-point","directions-destination-point","directions-waypoint-point","directions-route-line-alt"]});if(o.length){if(o.forEach(function(t){"directions-waypoint-point"===t.layer.id&&e.actions.removeWaypoint(t)}),"alternate"===o[0].properties.route){var s=o[0].properties["route-index"];this.actions.setRouteIndex(s)}}else this.actions.setDestinationFromCoordinates(i),this.map.flyTo({center:i})}else this.actions.setOriginFromCoordinates(i)}},{key:"_move",value:function(t){var e=this,n=I.getState(),r=n.hoverMarker,i=this.map.queryRenderedFeatures(t.point,{layers:["directions-route-line-alt","directions-route-line","directions-origin-point","directions-destination-point","directions-hover-point"]});this.map.getCanvas().style.cursor=i.length?"pointer":"",i.length?(this.isCursorOverPoint=i[0],this.map.dragPan.disable(),i.forEach(function(n){"directions-route-line"===n.layer.id?e.actions.hoverMarker([t.lngLat.lng,t.lngLat.lat]):r.geometry&&e.actions.hoverMarker(null)})):this.isCursorOverPoint&&(this.isCursorOverPoint=!1,this.map.dragPan.enable())}},{key:"_onDragDown",value:function(){this.isCursorOverPoint&&(this.isDragging=this.isCursorOverPoint,this.map.getCanvas().style.cursor="grab",this.map.on("mousemove",this.onDragMove),this.map.on("mouseup",this.onDragUp),this.map.on("touchmove",this.onDragMove),this.map.on("touchend",this.onDragUp))}},{key:"_onDragMove",value:function(t){if(this.isDragging){var e=[t.lngLat.lng,t.lngLat.lat];switch(this.isDragging.layer.id){case"directions-origin-point":this.actions.createOrigin(e);break;case"directions-destination-point":this.actions.createDestination(e);break;case"directions-hover-point":this.actions.hoverMarker(e)}}}},{key:"_onDragUp",value:function(){if(this.isDragging){var t=I.getState(),e=t.hoverMarker,n=t.origin,r=t.destination;switch(this.isDragging.layer.id){case"directions-origin-point":this.actions.setOriginFromCoordinates(n.geometry.coordinates);break;case"directions-destination-point":this.actions.setDestinationFromCoordinates(r.geometry.coordinates);break;case"directions-hover-point":
e.geometry&&!h["default"].coordinateMatch(this.isDragging,e)&&this.actions.addWaypoint(0,e)}this.isDragging=!1,this.map.getCanvas().style.cursor="",this.map.off("touchmove",this.onDragMove),this.map.off("touchend",this.onDragUp),this.map.off("mousemove",this.onDragMove),this.map.off("mouseup",this.onDragUp)}}},{key:"interactive",value:function(t){return t?(this.map.on("touchstart",this.move),this.map.on("touchstart",this.onDragDown),this.map.on("mousedown",this.onDragDown),this.map.on("mousemove",this.move),this.map.on("click",this.onClick)):(this.map.off("touchstart",this.move),this.map.off("touchstart",this.onDragDown),this.map.off("mousedown",this.onDragDown),this.map.off("mousemove",this.move),this.map.off("click",this.onClick)),this}},{key:"getOrigin",value:function(){return I.getState().origin}},{key:"setOrigin",value:function(t){return"string"==typeof t?this.actions.queryOrigin(t):this.actions.setOriginFromCoordinates(t),this}},{key:"getDestination",value:function(){return I.getState().destination}},{key:"setDestination",value:function(t){return"string"==typeof t?this.actions.queryDestination(t):this.actions.setDestinationFromCoordinates(t),this}},{key:"reverse",value:function(){return this.actions.reverse(),this}},{key:"addWaypoint",value:function(t,e){return e.type||(e=h["default"].createPoint(e,{id:"waypoint"})),this.actions.addWaypoint(t,e),this}},{key:"setWaypoint",value:function(t,e){return e.type||(e=h["default"].createPoint(e,{id:"waypoint"})),this.actions.setWaypoint(t,e),this}},{key:"removeWaypoint",value:function(t){var e=I.getState(),n=e.waypoints;return this.actions.removeWaypoint(n[t]),this}},{key:"getWaypoints",value:function(){return I.getState().waypoints}},{key:"on",value:function(t,e){return this.actions.eventSubscribe(t,e),this}}]),e}(mapboxgl.Control);n["default"]=S},{"./actions":38,"./controls/inputs":40,"./controls/instructions":41,"./directions_style":43,"./reducers":44,"./utils":45,polyline:21,redux:28,"redux-thunk":22}],43:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=[{id:"directions-route-line-alt",type:"line",source:"directions",layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":"#bbb","line-width":4},filter:["all",["in","$type","LineString"],["in","route","alternate"]]},{id:"directions-route-line",type:"line",source:"directions",layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":"#3bb2d0","line-width":4},filter:["all",["in","$type","LineString"],["in","route","selected"]]},{id:"directions-hover-point-casing",type:"circle",source:"directions",paint:{"circle-radius":8,"circle-color":"#fff"},filter:["all",["in","$type","Point"],["in","id","hover"]]},{id:"directions-hover-point",type:"circle",source:"directions",paint:{"circle-radius":6,"circle-color":"#3bb2d0"},filter:["all",["in","$type","Point"],["in","id","hover"]]},{id:"directions-waypoint-point-casing",type:"circle",source:"directions",paint:{"circle-radius":8,"circle-color":"#fff"},filter:["all",["in","$type","Point"],["in","id","waypoint"]]},{id:"directions-waypoint-point",type:"circle",source:"directions",paint:{"circle-radius":6,"circle-color":"#8a8bc9"},filter:["all",["in","$type","Point"],["in","id","waypoint"]]},{id:"directions-origin-point",type:"circle",source:"directions",paint:{"circle-radius":18,"circle-color":"#3bb2d0"},filter:["all",["in","$type","Point"],["in","marker-symbol","A"]]},{id:"directions-origin-label",type:"symbol",source:"directions",layout:{"text-field":"A","text-font":["Open Sans Bold","Arial Unicode MS Bold"],"text-size":12},paint:{"text-color":"#fff"},filter:["all",["in","$type","Point"],["in","marker-symbol","A"]]},{id:"directions-destination-point",type:"circle",source:"directions",paint:{"circle-radius":18,"circle-color":"#8a8bc9"},filter:["all",["in","$type","Point"],["in","marker-symbol","B"]]},{id:"directions-destination-label",type:"symbol",source:"directions",layout:{"text-field":"B","text-font":["Open Sans Bold","Arial Unicode MS Bold"],"text-size":12},paint:{"text-color":"#fff"},filter:["all",["in","$type","Point"],["in","marker-symbol","B"]]}];n["default"]=r},{}],44:[function(t,e,n){"use strict";function r(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e["default"]=t,e}function i(){var t=arguments.length<=0||void 0===arguments[0]?a:arguments[0],e=arguments[1];switch(e.type){case s.SET_OPTIONS:return Object.assign({},t,e.options);case s.DIRECTIONS_PROFILE:return Object.assign({},t,{profile:e.profile});case s.ORIGIN:return Object.assign({},t,{origin:e.origin,hoverMarker:{}});case s.DESTINATION:return Object.assign({},t,{destination:e.destination,hoverMarker:{}});case s.HOVER_MARKER:return Object.assign({},t,{hoverMarker:e.hoverMarker});case s.WAYPOINTS:return Object.assign({},t,{waypoints:e.waypoints});case s.ORIGIN_QUERY:return Object.assign({},t,{originQuery:e.query});case s.DESTINATION_QUERY:return Object.assign({},t,{destinationQuery:e.query});case s.ORIGIN_FROM_COORDINATES:return Object.assign({},t,{originQueryCoordinates:e.coordinates});case s.DESTINATION_FROM_COORDINATES:return Object.assign({},t,{destinationQueryCoordinates:e.coordinates});case s.ORIGIN_CLEAR:return Object.assign({},t,{origin:{},originQuery:"",waypoints:[],directions:[]});case s.DESTINATION_CLEAR:return Object.assign({},t,{destination:{},destinationQuery:"",waypoints:[],directions:[]});case s.DIRECTIONS:return Object.assign({},t,{directions:e.directions});case s.ROUTE_INDEX:return Object.assign({},t,{routeIndex:e.routeIndex});case s.ERROR:return Object.assign({},t,{error:e.error});default:return t}}Object.defineProperty(n,"__esModule",{value:!0});var o=t("../constants/action_types.js"),s=r(o),a={api:"https://api.mapbox.com/v4/directions/",profile:"driving",unit:"imperial",proximity:!1,styles:[],controls:{inputs:!0,instructions:!0},interactive:!0,events:{},origin:{},destination:{},hoverMarker:{},waypoints:[],originQuery:null,destinationQuery:null,originQueryCoordinates:null,destinationQueryCoordinates:null,directions:[],routeIndex:0};n["default"]=i},{"../constants/action_types.js":39}],45:[function(t,e,n){"use strict";function r(t){return t[0]>=-180&&t[0]<=180&&t[1]>=-90&&t[1]<=90}function i(t,e){return t=t.geometry.coordinates,e=e.geometry.coordinates,t.join()===e.join()||t[0].toFixed(3)===e[0].toFixed(3)&&t[1].toFixed(3)===e[1].toFixed(3)}function o(t){var e=360,n=((t- -180)%e+e)%e+-180;return n===-180?180:n}function s(t,e){return{type:"Feature",geometry:{type:"Point",coordinates:t},properties:e?e:{}}}Object.defineProperty(n,"__esModule",{value:!0});var a={duration:function(t){var e=Math.floor(t/60),n=Math.floor(e/60);return t%=60,e%=60,0===n&&0===e?t+"s":0===n?e+"min":n+"h "+e+"min"},imperial:function(t){var e=t/1609.344;return e>=100?e.toFixed(0)+"mi":e>=10?e.toFixed(1)+"mi":e>=.1?e.toFixed(2)+"mi":(5280*e).toFixed(0)+"ft"},metric:function(t){return t>=1e5?(t/1e3).toFixed(0)+"km":t>=1e4?(t/1e3).toFixed(1)+"km":t>=100?(t/1e3).toFixed(2)+"km":t.toFixed(0)+"m"}};n["default"]={format:a,coordinateMatch:i,createPoint:s,validCoords:r,wrap:o}},{}]},{},[1]);
